# ðŸŽ¬ Datanauts.co UGC Bot

Telegram-Ð±Ð¾Ñ‚ Ð´Ð»Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ UGC-Ñ€ÐµÐºÐ»Ð°Ð¼Ð½Ñ‹Ñ… Ñ€Ð¾Ð»Ð¸ÐºÐ¾Ð² Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ Ð˜Ð˜. ÐŸÐ¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑÐ¼ Ð²Ñ‹Ð±Ð¸Ñ€Ð°Ñ‚ÑŒ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶ÐµÐ¹, Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¸Ñ…, Ð²Ñ‹Ð±Ð¸Ñ€Ð°Ñ‚ÑŒ Ð³Ð¾Ð»Ð¾ÑÐ° Ð¸ Ð³ÐµÐ½ÐµÑ€Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð²Ð¸Ð´ÐµÐ¾ Ñ ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð°Ñ†Ð¸ÐµÐ¹ Ð³ÑƒÐ±.

## ðŸ—ï¸ ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð° Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°

### ÐžÐ±Ñ‰Ð°Ñ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð°

```
tg_bot/
â”œâ”€â”€ main.py                    # Ð¢Ð¾Ñ‡ÐºÐ° Ð²Ñ…Ð¾Ð´Ð° (ÑƒÐ¿Ñ€Ð¾Ñ‰ÐµÐ½Ð½Ð°Ñ, ~130 ÑÑ‚Ñ€Ð¾Ðº)
â”œâ”€â”€ dispatcher.py              # ÐžÐ±Ñ‰Ð¸Ð¹ dispatcher Ð´Ð»Ñ Ð²ÑÐµÑ… handlers
â”œâ”€â”€ startup.py                 # Ð›Ð¾Ð³Ð¸ÐºÐ° Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð±Ð¾Ñ‚Ð°
â”œâ”€â”€ config.py                  # ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ Ð¸ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ
â”œâ”€â”€ db.py                      # ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ…
â”œâ”€â”€ models.py                  # SQLAlchemy Ð¼Ð¾Ð´ÐµÐ»Ð¸
â”œâ”€â”€ states.py                  # FSM ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ
â”œâ”€â”€ keyboards.py               # Inline ÐºÐ»Ð°Ð²Ð¸Ð°Ñ‚ÑƒÑ€Ñ‹
â”œâ”€â”€ admin.py                   # ÐÐ´Ð¼Ð¸Ð½ÑÐºÐ¸Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹
â”œâ”€â”€ handlers/                  # ÐœÐ¾Ð´ÑƒÐ»Ð¸ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¾Ð² (Ð½Ð¾Ð²Ð°Ñ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð°)
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ start.py              # /start, FAQ, Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÑŒ
â”‚   â”œâ”€â”€ format_selection.py   # Ð’Ñ‹Ð±Ð¾Ñ€ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð° Ð²Ð¸Ð´ÐµÐ¾ (Ð½Ð¾Ð²Ð¾Ðµ!)
â”‚   â”œâ”€â”€ character_selection.py # Ð’Ñ‹Ð±Ð¾Ñ€ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð°
â”‚   â”œâ”€â”€ character_editing.py  # Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð°
â”‚   â”œâ”€â”€ voice_selection.py    # Ð’Ñ‹Ð±Ð¾Ñ€ Ð³Ð¾Ð»Ð¾ÑÐ°
â”‚   â”œâ”€â”€ generation.py         # Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ Ð°ÑƒÐ´Ð¸Ð¾/Ð²Ð¸Ð´ÐµÐ¾
â”‚   â”œâ”€â”€ my_generations.py     # Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¹
â”‚   â”œâ”€â”€ feedback.py           # ÐžÐ±Ñ€Ð°Ñ‚Ð½Ð°Ñ ÑÐ²ÑÐ·ÑŒ
â”‚   â”œâ”€â”€ credits.py            # ÐšÑ€ÐµÐ´Ð¸Ñ‚Ñ‹
â”‚   â””â”€â”€ navigation.py         # ÐÐ°Ð²Ð¸Ð³Ð°Ñ†Ð¸Ñ
â”œâ”€â”€ services/                  # Ð’Ð½ÐµÑˆÐ½Ð¸Ðµ ÑÐµÑ€Ð²Ð¸ÑÑ‹
â”‚   â”œâ”€â”€ elevenlabs_service.py # TTS Ñ‡ÐµÑ€ÐµÐ· ElevenLabs
â”‚   â”œâ”€â”€ falai_service.py      # Ð’Ð¸Ð´ÐµÐ¾ Ñ‡ÐµÑ€ÐµÐ· fal.ai OmniHuman
â”‚   â”œâ”€â”€ nano_banana_service.py # Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ‡ÐµÑ€ÐµÐ· fal.ai
â”‚   â”œâ”€â”€ r2_service.py         # Cloudflare R2 storage
â”‚   â””â”€â”€ scheduler_service.py  # ÐŸÐ»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ñ‰Ð¸Ðº Ð·Ð°Ð´Ð°Ñ‡
â””â”€â”€ utils/                     # Ð£Ñ‚Ð¸Ð»Ð¸Ñ‚Ñ‹
    â”œâ”€â”€ logger.py             # Ð¦ÐµÐ½Ñ‚Ñ€Ð°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ð¾Ðµ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ
    â”œâ”€â”€ credits.py            # Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð°Ð¼Ð¸
    â”œâ”€â”€ user_state.py         # Ð¡Ð¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
    â”œâ”€â”€ user_storage.py       # Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¹
    â”œâ”€â”€ user_activity.py      # ÐÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹
    â”œâ”€â”€ statistics.py          # Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°
    â”œâ”€â”€ files.py              # Ð Ð°Ð±Ð¾Ñ‚Ð° Ñ Ñ„Ð°Ð¹Ð»Ð°Ð¼Ð¸
    â”œâ”€â”€ voices.py             # Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð³Ð¾Ð»Ð¾ÑÐ°Ð¼Ð¸
    â”œâ”€â”€ audio.py              # ÐÑƒÐ´Ð¸Ð¾ ÑƒÑ‚Ð¸Ð»Ð¸Ñ‚Ñ‹
    â”œâ”€â”€ video.py              # Ð’Ð¸Ð´ÐµÐ¾ ÑƒÑ‚Ð¸Ð»Ð¸Ñ‚Ñ‹ (Ð½Ð¾Ð²Ð¾Ðµ!)
    â””â”€â”€ constants.py          # ÐšÐ¾Ð½ÑÑ‚Ð°Ð½Ñ‚Ñ‹
```

## ðŸ”§ ÐšÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ðµ Ð¼Ð¾Ð´ÑƒÐ»Ð¸

### 1. **main.py** - Ð¢Ð¾Ñ‡ÐºÐ° Ð²Ñ…Ð¾Ð´Ð°
- **Ð Ð°Ð·Ð¼ÐµÑ€**: ~130 ÑÑ‚Ñ€Ð¾Ðº (Ð±Ñ‹Ð»Ð¾ 1950)
- **ÐÐ°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ**: Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð±Ð¾Ñ‚Ð°, Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ handlers, Ð·Ð°Ð¿ÑƒÑÐº
- **ÐšÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸**:
  - ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ… Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ
  - Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ bot/dispatcher
  - Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð²ÑÐµÑ… handlers
  - Webhook/polling Ð»Ð¾Ð³Ð¸ÐºÐ°

### 2. **handlers/** - ÐœÐ¾Ð´ÑƒÐ»ÑŒÐ½Ð°Ñ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¾Ð²

#### **start.py** - ÐÐ°Ñ‡Ð°Ð»ÑŒÐ½Ñ‹Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹
```python
@CommandStart()
async def cmd_start(m: Message)

@dp.callback_query(F.data == "faq")
async def show_faq(c: CallbackQuery)

@dp.callback_query(F.data == "profile")
async def show_profile(c: CallbackQuery)
```

#### **character_selection.py** - Ð’Ñ‹Ð±Ð¾Ñ€ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð°
```python
@dp.callback_query(F.data == "select_character")
async def select_character(c: CallbackQuery, state: FSMContext)

@dp.callback_query(F.data == "gender_male")
async def gender_male_selected(c: CallbackQuery, state: FSMContext)
# Ð¡Ñ€Ð°Ð·Ñƒ Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ Ð³Ð°Ð»ÐµÑ€ÐµÑŽ Ð±ÐµÐ· Ð²Ñ‹Ð±Ð¾Ñ€Ð° Ð²Ð¾Ð·Ñ€Ð°ÑÑ‚Ð°

@dp.callback_query(F.data.startswith("char_pick:"))
async def character_picked(c: CallbackQuery, state: FSMContext)
# ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÑÐµÑ‚ Ð²Ð¾Ð·Ñ€Ð°ÑÑ‚ Ð¸Ð· Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ð¾Ð³Ð¾ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð°
```

#### **character_editing.py** - Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð°
```python
@dp.callback_query(F.data == "edit_character_yes")
async def edit_character_yes(c: CallbackQuery, state: FSMContext)

@dp.message(F.text, UGCCreation.waiting_edit_prompt)
async def handle_edit_prompt(m: Message, state: FSMContext)
```

#### **voice_selection.py** - Ð’Ñ‹Ð±Ð¾Ñ€ Ð³Ð¾Ð»Ð¾ÑÐ°
```python
async def show_voice_gallery(c: CallbackQuery, state: FSMContext)

@dp.callback_query(F.data.startswith("voice_pick:"))
async def voice_picked(c: CallbackQuery, state: FSMContext)
```

#### **generation.py** - Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ ÐºÐ¾Ð½Ñ‚ÐµÐ½Ñ‚Ð°
```python
@dp.callback_query(F.data == "audio_confirmed")
async def audio_confirmed(c: CallbackQuery, state: FSMContext)

@dp.message(F.text, UGCCreation.waiting_character_text)
async def character_text_received(m: Message, state: FSMContext)
```

### 3. **services/** - Ð’Ð½ÐµÑˆÐ½Ð¸Ðµ ÑÐµÑ€Ð²Ð¸ÑÑ‹

#### **elevenlabs_service.py** - TTS
- Ð¡Ð¸Ð½Ñ‚ÐµÐ· Ñ€ÐµÑ‡Ð¸ Ñ‡ÐµÑ€ÐµÐ· ElevenLabs API
- ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° Ð¼Ð½Ð¾Ð¶ÐµÑÑ‚Ð²Ð° Ð³Ð¾Ð»Ð¾ÑÐ¾Ð²
- Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð² R2 storage

#### **falai_service.py** - Ð’Ð¸Ð´ÐµÐ¾ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ
- Talking head Ð²Ð¸Ð´ÐµÐ¾ Ñ‡ÐµÑ€ÐµÐ· fal.ai OmniHuman
- Ð¡Ð¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð³ÑƒÐ± Ñ Ð°ÑƒÐ´Ð¸Ð¾
- ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¹ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶ÐµÐ¹

#### **video_editing_service.py** - Ð’Ð¸Ð´ÐµÐ¾Ð¼Ð¾Ð½Ñ‚Ð°Ð¶
- ÐšÐ¾Ð¼Ð¿Ð¾Ð·Ð¸Ñ‚Ð¸Ð½Ð³ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð° Ñ Ñ„Ð¾Ð½Ð¾Ð²Ñ‹Ð¼ Ð²Ð¸Ð´ÐµÐ¾
- Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ Ñ Shotstack API
- Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÑÑƒÐ±Ñ‚Ð¸Ñ‚Ñ€Ð¾Ð²
- Ð”ÐµÑ‚Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸
- **Ð£Ð¼Ð½Ð¾Ðµ ÐºÐµÑˆÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ð²ÐµÑ€Ð»ÐµÐµÐ²**:
  - ÐžÐ²ÐµÑ€Ð»ÐµÐ¸ ÐºÐµÑˆÐ¸Ñ€ÑƒÑŽÑ‚ÑÑ Ð½Ð° 24 Ñ‡Ð°ÑÐ° Ð² R2
  - ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð¾Ñ‡Ð¸ÑÑ‚ÐºÐ° Ð¿Ñ€Ð¸ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¸ Ð½Ð¾Ð²Ð¾Ð³Ð¾ Ð²Ð¸Ð´ÐµÐ¾
  - ÐšÐ¾Ð¼Ð°Ð½Ð´Ð° `/overlay` Ð´Ð»Ñ Ð¿Ñ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð¹ Ð¿ÐµÑ€ÐµÐ³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¸
  - Ð­ÐºÐ¾Ð½Ð¾Ð¼Ð¸Ñ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ Ð¸ ÑÑ€ÐµÐ´ÑÑ‚Ð² Ð½Ð° Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ñ‹Ñ… Ð¼Ð¾Ð½Ñ‚Ð°Ð¶Ð°Ñ…

#### **modal_client.py** - Modal GPU ÐºÐ»Ð¸ÐµÐ½Ñ‚
- ÐÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ð°Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° overlay Ð½Ð° GPU
- Ð£ÑÐºÐ¾Ñ€ÐµÐ½Ð¸Ðµ Ð² 10-20 Ñ€Ð°Ð· (30-60s Ð²Ð¼ÐµÑÑ‚Ð¾ 10+ Ð¼Ð¸Ð½ÑƒÑ‚)
- Fallback Ð½Ð° CPU Ð¿Ñ€Ð¸ Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚Ð¸
- Ð¡Ñ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ: ~$0.06-0.12 Ð·Ð° Ð²Ð¸Ð´ÐµÐ¾

#### **nano_banana_service.py** - Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ
- AI-Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶ÐµÐ¹
- Ð˜Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ñ„Ð¾Ð½Ð°, Ð¾Ð´ÐµÐ¶Ð´Ñ‹, Ð°ÐºÑÐµÑÑÑƒÐ°Ñ€Ð¾Ð²
- Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ Ñ fal.ai nano-banana

#### **openai_enhancement_service.py** - ÐÐ½Ð°Ð»Ð¸Ð· ÑÐ¼Ð¾Ñ†Ð¸Ð¹
- Ð Ð°Ð·Ð±Ð¸Ð²ÐºÐ° Ñ‚ÐµÐºÑÑ‚Ð° Ð½Ð° ÑÐµÐ³Ð¼ÐµÐ½Ñ‚Ñ‹ Ð¿Ð¾ ÑÐ¼Ð¾Ñ†Ð¸ÑÐ¼ Ñ‡ÐµÑ€ÐµÐ· OpenAI fine-tuned Ð¼Ð¾Ð´ÐµÐ»ÑŒ
- ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð° `[emotion] text` Ñ Ð¼Ð½Ð¾Ð¶ÐµÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ð¼Ð¸ ÑÐ¼Ð¾Ñ†Ð¸ÑÐ¼Ð¸
- ÐšÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ñ‹Ð¹ Ð¿Ð°Ñ€ÑÐ¸Ð½Ð³ ÑÐ¼Ð¾Ñ†Ð¸Ð¹ Ð½Ð° Ð¾Ð´Ð½Ð¾Ð¹ ÑÑ‚Ñ€Ð¾ÐºÐµ Ð¸ Ñ Ð¿ÐµÑ€ÐµÐ½Ð¾ÑÐ°Ð¼Ð¸
- ÐÐ¾Ñ€Ð¼Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ ÑÐ¼Ð¾Ñ†Ð¸Ð¹ Ð´Ð»Ñ MiniMax TTS API

#### **minimax_service.py** - TTS Ñ ÑÐ¼Ð¾Ñ†Ð¸ÑÐ¼Ð¸
- Ð¡Ð¸Ð½Ñ‚ÐµÐ· Ñ€ÐµÑ‡Ð¸ Ñ‡ÐµÑ€ÐµÐ· MiniMax Speech-02 Turbo (fal.ai)
- ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° ÑÐ¼Ð¾Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ð¹ Ð¾ÐºÑ€Ð°ÑÐºÐ¸ Ð³Ð¾Ð»Ð¾ÑÐ°
- Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ Ð¿Ð¾ ÑÐµÐ³Ð¼ÐµÐ½Ñ‚Ð°Ð¼ Ñ Ñ€Ð°Ð·Ð½Ñ‹Ð¼Ð¸ ÑÐ¼Ð¾Ñ†Ð¸ÑÐ¼Ð¸
- ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ ÑÐºÐ»ÐµÐ¹ÐºÐ° Ð°ÑƒÐ´Ð¸Ð¾ ÑÐµÐ³Ð¼ÐµÐ½Ñ‚Ð¾Ð²

#### **r2_service.py** - ÐžÐ±Ð»Ð°Ñ‡Ð½Ð¾Ðµ Ñ…Ñ€Ð°Ð½Ð¸Ð»Ð¸Ñ‰Ðµ
- Cloudflare R2 (S3-ÑÐ¾Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ð¾Ðµ)
- Presigned URLs Ð´Ð»Ñ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð°
- Lifecycle policies Ð´Ð»Ñ Ð°Ð²Ñ‚Ð¾Ð¾Ñ‡Ð¸ÑÑ‚ÐºÐ¸

### 4. **utils/** - Ð£Ñ‚Ð¸Ð»Ð¸Ñ‚Ñ‹

#### **logger.py** - Ð¦ÐµÐ½Ñ‚Ñ€Ð°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ð¾Ðµ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ
```python
def setup_logger(name: str, level: int = logging.INFO) -> logging.Logger
def get_logger(name: str) -> logging.Logger

# ÐŸÑ€ÐµÐ´ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ‹Ðµ Ð»Ð¾Ð³Ð³ÐµÑ€Ñ‹
ugc_logger = setup_logger("ugc_creation")
tts_logger = setup_logger("tts")
falai_logger = setup_logger("falai")
```

#### **user_state.py** - Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸ÐµÐ¼
```python
# Character selection
set_character_gender(tg_id: int, gender: str)
get_character_gender(tg_id: int) -> Optional[str]
set_character_age(tg_id: int, age: str)  # Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÑ‚ÑÑ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð¿Ñ€Ð¸ Ð²Ñ‹Ð±Ð¾Ñ€Ðµ
get_character_age(tg_id: int) -> Optional[str]

# Pagination
set_character_page(tg_id: int, page: int)
get_character_page(tg_id: int) -> int
set_voice_page(tg_id: int, page: int)
get_voice_page(tg_id: int) -> int

# Character editing
set_original_character_path(tg_id: int, path: str)
set_edited_character_path(tg_id: int, path: str)
clear_edit_session(tg_id: int)
```

#### **credits.py** - Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð¾Ð²
```python
ensure_user(tg_id: int)  # Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ñ Ð±Ð¾Ð½ÑƒÑÐ¾Ð¼
get_credits(tg_id: int) -> int
add_credits(tg_id: int, amount: int, reason: str)
spend_credits(tg_id: int, amount: int, reason: str) -> bool
```

## ðŸ”„ ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ð¹ Ñ„Ð»Ð¾Ñƒ

### 1. **Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð¸ Ð½Ð°Ñ‡Ð°Ð»Ð¾**
```
/start â†’ Ð”Ð¾Ð±Ñ€Ð¾ Ð¿Ð¾Ð¶Ð°Ð»Ð¾Ð²Ð°Ñ‚ÑŒ + Ð±Ð¾Ð½ÑƒÑ ÐºÑ€ÐµÐ´Ð¸Ñ‚Ñ‹
```

### Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹

- `/start` - ÐÐ°Ñ‡Ð°Ñ‚ÑŒ Ñ€Ð°Ð±Ð¾Ñ‚Ñƒ Ñ Ð±Ð¾Ñ‚Ð¾Ð¼
- `/resume` - Ð’Ð¾Ð·Ð¾Ð±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ð½ÐµÐ·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð½Ñ‹Ð¹ Ð¼Ð¾Ð½Ñ‚Ð°Ð¶ (Ð¿Ð¾ÑÐ»Ðµ Ð¿ÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐºÐ° Ð±Ð¾Ñ‚Ð°)
- `/overlay` - ÐŸÐµÑ€ÐµÐ³ÐµÐ½ÐµÑ€Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¾Ð²ÐµÑ€Ð»ÐµÐ¹ Ð´Ð»Ñ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ Ð²Ð¸Ð´ÐµÐ¾ (Ð¾Ñ‡Ð¸Ñ‰Ð°ÐµÑ‚ ÐºÐµÑˆ Ð¸ ÑÐ¾Ð·Ð´Ð°ÐµÑ‚ Ð½Ð¾Ð²Ñ‹Ð¹ Ð¾Ð²ÐµÑ€Ð»ÐµÐ¹)

### 2. **Ð’Ñ‹Ð±Ð¾Ñ€ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð° Ð²Ð¸Ð´ÐµÐ¾** (Ð½Ð¾Ð²Ð¾Ðµ!)
```
Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ UGC (/create Ð¸Ð»Ð¸ ÐºÐ½Ð¾Ð¿ÐºÐ°) â†’ Ð’Ñ‹Ð±Ð¾Ñ€ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð°:
  â”œâ”€ ðŸ‘¤ Ð“Ð¾Ð²Ð¾Ñ€ÑÑ‰Ð°Ñ Ð³Ð¾Ð»Ð¾Ð²Ð° â†’ Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶Ð¸Ñ‚ÑŒ Ð¾Ð±Ñ‹Ñ‡Ð½Ñ‹Ð¹ Ñ„Ð»Ð¾Ñƒ
  â””â”€ ðŸŽ¬ ÐŸÐµÑ€ÑÐ¾Ð½Ð°Ð¶ Ñ Ð±ÐµÐºÐ³Ñ€Ð°ÑƒÐ½Ð´Ð¾Ð¼ â†’ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ñ„Ð¾Ð½Ð¾Ð²Ð¾Ð³Ð¾ Ð²Ð¸Ð´ÐµÐ¾ (Ð¼Ð°ÐºÑ 15 ÑÐµÐº) â†’ Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶Ð¸Ñ‚ÑŒ Ñ„Ð»Ð¾Ñƒ
```

**Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚Ñ‹ Ð²Ð¸Ð´ÐµÐ¾:**
- **Ð“Ð¾Ð²Ð¾Ñ€ÑÑ‰Ð°Ñ Ð³Ð¾Ð»Ð¾Ð²Ð°** - ÐºÐ»Ð°ÑÑÐ¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚ Ñ AI-Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶ÐµÐ¼
- **ÐŸÐµÑ€ÑÐ¾Ð½Ð°Ð¶ Ñ Ð±ÐµÐºÐ³Ñ€Ð°ÑƒÐ½Ð´Ð¾Ð¼** - Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶ Ð½Ð° Ñ„Ð¾Ð½Ðµ Ð²Ð°ÑˆÐµÐ³Ð¾ Ð²Ð¸Ð´ÐµÐ¾ (Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ñ„Ð¾Ð½Ð¾Ð²Ð¾Ð³Ð¾ Ð²Ð¸Ð´ÐµÐ¾)

### 3. **Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ UGC Ñ€ÐµÐºÐ»Ð°Ð¼Ñ‹**
```
Ð’Ñ‹Ð±Ð¾Ñ€ Ð¿Ð¾Ð»Ð° â†’ Ð“Ð°Ð»ÐµÑ€ÐµÑ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶ÐµÐ¹ (Ð²ÑÐµ Ð²Ð¾Ð·Ñ€Ð°ÑÑ‚Ñ‹ Ð²Ð¼ÐµÑÑ‚Ðµ)
```

### 4. **Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð°** (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)
```
Ð’Ñ‹Ð±Ð¾Ñ€ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð° â†’ Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ? â†’ ÐŸÑ€Ð¾Ð¼Ð¿Ñ‚ â†’ Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ â†’ Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ/ÐŸÑ€Ð¾Ð´Ð¾Ð»Ð¶Ð¸Ñ‚ÑŒ/ÐžÑ€Ð¸Ð³Ð¸Ð½Ð°Ð»
```

### 5. **Ð’Ñ‹Ð±Ð¾Ñ€ Ð³Ð¾Ð»Ð¾ÑÐ°**
```
Ð“Ð°Ð»ÐµÑ€ÐµÑ Ð³Ð¾Ð»Ð¾ÑÐ¾Ð² â†’ Ð’Ñ‹Ð±Ð¾Ñ€ Ð³Ð¾Ð»Ð¾ÑÐ° â†’ Ð’Ð²Ð¾Ð´ Ñ‚ÐµÐºÑÑ‚Ð°
```

### 6. **Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ**
```
TTS â†’ ÐŸÑ€Ð¾ÑÐ»ÑƒÑˆÐ¸Ð²Ð°Ð½Ð¸Ðµ â†’ ÐŸÐ¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¸Ðµ â†’ Ð’Ð¸Ð´ÐµÐ¾ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ â†’ Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚
```

## ðŸ—„ï¸ Ð‘Ð°Ð·Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ…

### ÐœÐ¾Ð´ÐµÐ»Ð¸ (SQLAlchemy)

#### **User** - ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ð¸
```python
class User(Base):
    id: int = Column(Integer, primary_key=True)
    tg_id: int = Column(BigInteger, unique=True, nullable=False)
    credits: int = Column(Integer, default=0)
    selected_voice_id: Optional[str] = Column(String)
    created_at: datetime = Column(DateTime, default=datetime.utcnow)
```

#### **UserState** - Ð¡Ð¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
```python
class UserState(Base):
    user_id: int = Column(Integer, ForeignKey("users.id"), primary_key=True)
    selected_character_idx: Optional[int] = Column(Integer)
    character_text: Optional[str] = Column(Text)
    character_gender: Optional[str] = Column(String)
    character_age: Optional[str] = Column(String)
    character_page: int = Column(Integer, default=0)
    voice_page: int = Column(Integer, default=0)
    original_character_path: Optional[str] = Column(String)
    edited_character_path: Optional[str] = Column(String)
    edit_iteration_count: int = Column(Integer, default=0)
    video_format: Optional[str] = Column(String)  # 'talking_head' Ð¸Ð»Ð¸ 'character_with_background'
    background_video_path: Optional[str] = Column(String)  # R2 Ð¿ÑƒÑ‚ÑŒ Ðº Ñ„Ð¾Ð½Ð¾Ð²Ð¾Ð¼Ñƒ Ð²Ð¸Ð´ÐµÐ¾
```

#### **GenerationHistory** - Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¹
```python
class GenerationHistory(Base):
    id: int = Column(Integer, primary_key=True)
    user_id: int = Column(Integer, ForeignKey("users.id"))
    generation_type: str = Column(String)  # 'video', 'audio'
    r2_video_key: Optional[str] = Column(String)
    r2_audio_key: Optional[str] = Column(String)
    character_gender: Optional[str] = Column(String)
    character_age: Optional[str] = Column(String)
    text_prompt: Optional[str] = Column(Text)
    credits_spent: int = Column(Integer)
    created_at: datetime = Column(DateTime, default=datetime.utcnow)
```

## ðŸš€ Ð Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ðµ

### ÐŸÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ
```bash
# ÐžÐ±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ
TELEGRAM_BOT_TOKEN=your_bot_token
WEBHOOK_URL=https://your-domain.com/webhook

# AI ÑÐµÑ€Ð²Ð¸ÑÑ‹
ELEVEN_API_KEY=your_elevenlabs_key
FALAI_API_TOKEN=your_falai_token

# Ð‘Ð°Ð·Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ…
DATABASE_URL=postgresql://user:pass@host:port/db

# R2 Storage
R2_ACCESS_KEY_ID=your_access_key
R2_SECRET_ACCESS_KEY=your_secret_key
R2_BUCKET_NAME=your_bucket
R2_ENDPOINT_URL=https://your-account.r2.cloudflarestorage.com

# Ð’Ð¸Ð´ÐµÐ¾Ð¼Ð¾Ð½Ñ‚Ð°Ð¶
SHOTSTACK_API_KEY=your_shotstack_key
SHOTSTACK_STAGE=v1
MODAL_OVERLAY_ENDPOINT=https://user--app-submit.modal.run  # ÐžÐ¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾, Ð´Ð»Ñ GPU ÑƒÑÐºÐ¾Ñ€ÐµÐ½Ð¸Ñ

# ÐÐ´Ð¼Ð¸Ð½ÐºÐ°
ADMIN_FEEDBACK_CHAT_ID=your_admin_chat_id
```

### Modal GPU (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)

Ð”Ð»Ñ **ÑƒÑÐºÐ¾Ñ€ÐµÐ½Ð¸Ñ Ð²Ð¸Ð´ÐµÐ¾Ð¼Ð¾Ð½Ñ‚Ð°Ð¶Ð° Ð² 10-20 Ñ€Ð°Ð·**:

1. Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Modal CLI: `pip install modal && modal token new`
2. Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ secret "shotstuck" Ð² Modal Ñ `SHOTSTACK_API_KEY`
3. Ð—Ð°Ð´ÐµÐ¿Ð»Ð¾Ð¸Ñ‚ÑŒ: `modal deploy modal_services/overlay_service.py`
4. Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ endpoint URL Ð² Railway ÐºÐ°Ðº `MODAL_OVERLAY_ENDPOINT`

**ÐŸÑ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ:**
- Ð¡ Modal GPU (A10G): **30-60 ÑÐµÐºÑƒÐ½Ð´**
- Ð‘ÐµÐ· Modal (Railway CPU): **10+ Ð¼Ð¸Ð½ÑƒÑ‚**
- Ð¡Ñ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ: ~$0.06-0.12 Ð·Ð° Ð²Ð¸Ð´ÐµÐ¾

### Railway Ñ€Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ðµ
```bash
# 1. ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒ GitHub Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¹
# 2. ÐÐ°ÑÑ‚Ñ€Ð¾Ð¸Ñ‚ÑŒ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ
# 3. Ð”ÐµÐ¿Ð»Ð¾Ð¹ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¿Ñ€Ð¸ push
```

## ðŸ§ª Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ

### Ð›Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾Ðµ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ
```bash
# 1. Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸
pip install -r requirements.txt

# 2. ÐÐ°ÑÑ‚Ñ€Ð¾Ð¸Ñ‚ÑŒ .env Ñ„Ð°Ð¹Ð»
cp .env.example .env

# 3. Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ Ð±Ð¾Ñ‚Ð°
python -m tg_bot.main
```

### ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸
- âœ… Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹
- âœ… Ð’Ñ‹Ð±Ð¾Ñ€ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð° (Ð¿Ð¾Ð»/Ð²Ð¾Ð·Ñ€Ð°ÑÑ‚/Ð³Ð°Ð»ÐµÑ€ÐµÑ)
- âœ… Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð°
- âœ… Ð’Ñ‹Ð±Ð¾Ñ€ Ð³Ð¾Ð»Ð¾ÑÐ°
- âœ… TTS Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ
- âœ… Ð’Ð¸Ð´ÐµÐ¾ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ
- âœ… Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¹
- âœ… ÐÐ´Ð¼Ð¸Ð½ÑÐºÐ¸Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹

## ðŸ“ˆ ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð¸ Ð»Ð¾Ð³Ð¸

### Ð¦ÐµÐ½Ñ‚Ñ€Ð°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ð¾Ðµ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ
```python
from tg_bot.utils.logger import setup_logger

logger = setup_logger(__name__)
logger.info("User action completed")
logger.error("Error occurred")
logger.warning("Warning message")
```

### Ð›Ð¾Ð³Ð¸ Ð¿Ð¾ Ð¼Ð¾Ð´ÑƒÐ»ÑÐ¼
- `ugc_creation` - Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ UGC ÐºÐ¾Ð½Ñ‚ÐµÐ½Ñ‚Ð°
- `tts` - TTS Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ
- `falai` - Ð’Ð¸Ð´ÐµÐ¾ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ
- `r2` - ÐžÐ±Ð»Ð°Ñ‡Ð½Ð¾Ðµ Ñ…Ñ€Ð°Ð½Ð¸Ð»Ð¸Ñ‰Ðµ
- `admin` - ÐÐ´Ð¼Ð¸Ð½ÑÐºÐ¸Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹
- `statistics` - Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°

## ðŸ”® Ð”Ð°Ð»ÑŒÐ½ÐµÐ¹ÑˆÐµÐµ Ñ€Ð°Ð·Ð²Ð¸Ñ‚Ð¸Ðµ

### ÐšÑ€Ð°Ñ‚ÐºÐ¾ÑÑ€Ð¾Ñ‡Ð½Ñ‹Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸ (1-2 Ð½ÐµÐ´ÐµÐ»Ð¸)
1. **Ð£Ð»ÑƒÑ‡ÑˆÐµÐ½Ð¸Ðµ UI/UX**
   - Ð‘Ð¾Ð»ÐµÐµ ÐºÑ€Ð°ÑÐ¸Ð²Ñ‹Ðµ ÐºÐ»Ð°Ð²Ð¸Ð°Ñ‚ÑƒÑ€Ñ‹
   - ÐŸÑ€Ð¾Ð³Ñ€ÐµÑÑ-Ð±Ð°Ñ€Ñ‹ Ð´Ð»Ñ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¸
   - ÐŸÑ€ÐµÐ´Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶ÐµÐ¹

2. **ÐžÐ¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸**
   - ÐšÑÑˆÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ R2 URLs
   - ÐÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ð°Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ñ„Ð°Ð¹Ð»Ð¾Ð²
   - ÐžÐ¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð² Ðº Ð‘Ð”

3. **Ð Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸**
   - Ð‘Ð¾Ð»ÑŒÑˆÐµ Ð³Ð¾Ð»Ð¾ÑÐ¾Ð² Ð¸ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶ÐµÐ¹
   - ÐÐ¾Ð²Ñ‹Ðµ ÑÑ‚Ð¸Ð»Ð¸ Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ
   - ÐŸÐ°ÐºÐµÑ‚Ð½Ð°Ñ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ

### Ð¡Ñ€ÐµÐ´Ð½ÐµÑÑ€Ð¾Ñ‡Ð½Ñ‹Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸ (1-2 Ð¼ÐµÑÑÑ†Ð°)
1. **ÐÐ½Ð°Ð»Ð¸Ñ‚Ð¸ÐºÐ° Ð¸ Ð¼ÐµÑ‚Ñ€Ð¸ÐºÐ¸**
   - Dashboard Ð´Ð»Ñ Ð°Ð´Ð¼Ð¸Ð½Ð¾Ð²
   - A/B Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ
   - ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÑÐºÐ°Ñ Ð°Ð½Ð°Ð»Ð¸Ñ‚Ð¸ÐºÐ°

2. **ÐœÐ¾Ð½ÐµÑ‚Ð¸Ð·Ð°Ñ†Ð¸Ñ**
   - ÐŸÐ¾Ð´Ð¿Ð¸ÑÐºÐ¸
   - ÐŸÐ»Ð°Ñ‚Ð½Ñ‹Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸
   - Ð ÐµÑ„ÐµÑ€Ð°Ð»ÑŒÐ½Ð°Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ð°

3. **Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ð¸**
   - API Ð´Ð»Ñ Ð²Ð½ÐµÑˆÐ½Ð¸Ñ… ÑÐµÑ€Ð²Ð¸ÑÐ¾Ð²
   - Webhook ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ
   - Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚ Ð² ÑÐ¾Ñ†Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ðµ ÑÐµÑ‚Ð¸

### Ð”Ð¾Ð»Ð³Ð¾ÑÑ€Ð¾Ñ‡Ð½Ñ‹Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸ (3+ Ð¼ÐµÑÑÑ†Ð°)
1. **ÐœÐ°ÑÑˆÑ‚Ð°Ð±Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ**
   - ÐœÐ¸ÐºÑ€Ð¾ÑÐµÑ€Ð²Ð¸ÑÐ½Ð°Ñ Ð°Ñ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð°
   - Kubernetes Ñ€Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ðµ
   - Ð“Ð¾Ñ€Ð¸Ð·Ð¾Ð½Ñ‚Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð¼Ð°ÑÑˆÑ‚Ð°Ð±Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ

2. **AI/ML ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð¸Ñ**
   - Ð¡Ð¾Ð±ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ðµ Ð¼Ð¾Ð´ÐµÐ»Ð¸
   - ÐŸÐµÑ€ÑÐ¾Ð½Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ
   - ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð¾Ð¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ñ

3. **ÐœÐµÐ¶Ð´ÑƒÐ½Ð°Ñ€Ð¾Ð´Ð½Ð°Ñ ÑÐºÑÐ¿Ð°Ð½ÑÐ¸Ñ**
   - ÐœÑƒÐ»ÑŒÑ‚Ð¸ÑÐ·Ñ‹Ñ‡Ð½Ð¾ÑÑ‚ÑŒ
   - Ð›Ð¾ÐºÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð¸
   - Ð ÐµÐ³Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð¾ÑÐ¾Ð±ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸

## ðŸ› ï¸ Ð Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ°

### Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð½Ð¾Ð²Ð¾Ð³Ð¾ handler
1. Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ñ„Ð°Ð¹Ð» Ð² `handlers/new_feature.py`
2. Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚ Ð² `handlers/__init__.py`
3. Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð´ÐµÐºÐ¾Ñ€Ð°Ñ‚Ð¾Ñ€Ñ‹ Ñ `@dp.callback_query` Ð¸Ð»Ð¸ `@dp.message`

### Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð½Ð¾Ð²Ð¾Ð³Ð¾ ÑÐµÑ€Ð²Ð¸ÑÐ°
1. Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ñ„Ð°Ð¹Ð» Ð² `services/new_service.py`
2. Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð² `utils/logger.py` ÑÐ¿ÐµÑ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ Ð»Ð¾Ð³Ð³ÐµÑ€
3. Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð² ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ðµ handlers

### Ð Ð°Ð±Ð¾Ñ‚Ð° Ñ Ð±Ð°Ð·Ð¾Ð¹ Ð´Ð°Ð½Ð½Ñ‹Ñ…
1. Ð˜Ð·Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ð¼Ð¾Ð´ÐµÐ»ÑŒ Ð² `models.py`
2. Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸ÑŽ Ð² `startup.py`
3. ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ ÑƒÑ‚Ð¸Ð»Ð¸Ñ‚Ñ‹ Ð² `utils/`

## ðŸ“š Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ API

### ÐžÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ endpoints
- `/webhook` - Telegram webhook
- `/health` - Health check
- `/` - Root endpoint

### Ð’Ð½ÐµÑˆÐ½Ð¸Ðµ API
- **ElevenLabs** - TTS ÑÐ¸Ð½Ñ‚ÐµÐ·
- **fal.ai** - Ð’Ð¸Ð´ÐµÐ¾ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ Ð¸ Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ
- **Cloudflare R2** - Ð¤Ð°Ð¹Ð»Ð¾Ð²Ð¾Ðµ Ñ…Ñ€Ð°Ð½Ð¸Ð»Ð¸Ñ‰Ðµ

## ðŸ¤ Ð£Ñ‡Ð°ÑÑ‚Ð¸Ðµ Ð² Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐµ

### Git workflow
1. Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ feature branch
2. Ð’Ð½ÐµÑÑ‚Ð¸ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ
3. ÐŸÑ€Ð¾Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾
4. Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Pull Request
5. Code review
6. Merge Ð² main

### Code style
- PEP 8 Ð´Ð»Ñ Python
- Type hints Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹
- Docstrings Ð´Ð»Ñ Ð²ÑÐµÑ… Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹
- Ð›Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ‡ÐµÑ€ÐµÐ· Ñ†ÐµÐ½Ñ‚Ñ€Ð°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ logger

---

## ðŸ“ž ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ°

ÐŸÑ€Ð¸ Ð²Ð¾Ð·Ð½Ð¸ÐºÐ½Ð¾Ð²ÐµÐ½Ð¸Ð¸ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ¾Ð² Ð¸Ð»Ð¸ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼:
1. ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð»Ð¾Ð³Ð¸ Ð² Railway dashboard
2. ÐžÐ±Ñ€Ð°Ñ‚Ð¸Ñ‚ÑŒÑÑ Ðº Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ñƒ Ñ‡ÐµÑ€ÐµÐ· Ð±Ð¾Ñ‚Ð°
3. Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ issue Ð² GitHub Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¸

**Ð’ÐµÑ€ÑÐ¸Ñ**: 2.1  
**ÐŸÐ¾ÑÐ»ÐµÐ´Ð½ÐµÐµ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ**: ÐžÐºÑ‚ÑÐ±Ñ€ÑŒ 2025  
**Ð¡Ñ‚Ð°Ñ‚ÑƒÑ**: Production Ready âœ…

## ðŸ†• Ð§Ñ‚Ð¾ Ð½Ð¾Ð²Ð¾Ð³Ð¾ Ð² v2.1

- ðŸš€ **Modal GPU Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ** - Ð²Ð¸Ð´ÐµÐ¾Ð¼Ð¾Ð½Ñ‚Ð°Ð¶ Ð·Ð° 30-60 ÑÐµÐºÑƒÐ½Ð´ (Ð±Ñ‹Ð»Ð¾ 10+ Ð¼Ð¸Ð½ÑƒÑ‚)
- ðŸ“Š **Ð”ÐµÑ‚Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ** - Ð´Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÐ° Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸ ÐºÐ°Ð¶Ð´Ð¾Ð³Ð¾ ÑÑ‚Ð°Ð¿Ð°
- ðŸŽ¬ **video_editing_service.py** - ÐºÐ¾Ð¼Ð¿Ð¾Ð·Ð¸Ñ‚Ð¸Ð½Ð³ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð° Ñ Ð±ÐµÐºÐ³Ñ€Ð°ÑƒÐ½Ð´Ð¾Ð¼ Ñ‡ÐµÑ€ÐµÐ· Shotstack
- âš™ï¸ **Ð“Ð¸Ð±Ñ€Ð¸Ð´Ð½Ð°Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ°** - Modal GPU Ð´Ð»Ñ overlay + Railway Ð´Ð»Ñ Ð¾Ñ€ÐºÐµÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸
- ðŸ’° **Ð­Ñ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ** - Ð¿Ð»Ð°Ñ‚Ð¸ÑˆÑŒ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð·Ð° GPU Ð²Ñ€ÐµÐ¼Ñ (~$0.06-0.12/Ð²Ð¸Ð´ÐµÐ¾)
- ðŸ—‘ï¸ **Ð£Ð¼Ð½Ð¾Ðµ ÐºÐµÑˆÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ** - Ð¾Ð²ÐµÑ€Ð»ÐµÐ¸ ÐºÐµÑˆÐ¸Ñ€ÑƒÑŽÑ‚ÑÑ Ð½Ð° 24 Ñ‡Ð°ÑÐ°, Ð°Ð²Ñ‚Ð¾Ð¾Ñ‡Ð¸ÑÑ‚ÐºÐ° Ð¿Ñ€Ð¸ Ð½Ð¾Ð²Ð¾Ð¼ Ð²Ð¸Ð´ÐµÐ¾
- ðŸ”„ **ÐšÐ¾Ð¼Ð°Ð½Ð´Ð° /overlay** - Ð¿ÐµÑ€ÐµÐ³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ Ð¾Ð²ÐµÑ€Ð»ÐµÑ Ð±ÐµÐ· ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð½Ð¾Ð²Ð¾Ð³Ð¾ Ð²Ð¸Ð´ÐµÐ¾
- ðŸŽ¯ **ÐÐ²Ñ‚Ð¾Ñ†ÐµÐ½Ñ‚Ñ€Ð¾Ð²ÐºÐ°** - Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ñ†ÐµÐ½Ñ‚Ñ€Ð° Ð»Ð¸Ñ†Ð° Ð´Ð»Ñ ÐºÑ€ÑƒÐ³Ð»Ð¾Ð³Ð¾ Ð¾Ð²ÐµÑ€Ð»ÐµÑ
- ðŸŽ­ **Ð¤Ð¸ÐºÑ Ð¿Ð°Ñ€ÑÐ¸Ð½Ð³Ð° ÑÐ¼Ð¾Ñ†Ð¸Ð¹** - ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð°Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¼Ð½Ð¾Ð¶ÐµÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ñ… ÑÐ¼Ð¾Ñ†Ð¸Ð¹ Ð² Ð¾Ð´Ð½Ð¾Ð¹ ÑÑ‚Ñ€Ð¾ÐºÐµ
- âš¡ **ÐžÐ³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ðµ ÑÐºÐ¾Ñ€Ð¾ÑÑ‚Ð¸ Ð²Ð¸Ð´ÐµÐ¾** - Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ðµ Ð´Ð¾ 10x (Ð»Ð¸Ð¼Ð¸Ñ‚ Shotstack API)
- ðŸ“ **Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð±Ð¾Ð»ÑŒÑˆÐ¸Ñ… Ð²Ð¸Ð´ÐµÐ¾** - Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ñ‡ÐµÑ€ÐµÐ· URL Ð´Ð»Ñ Ñ„Ð°Ð¹Ð»Ð¾Ð² > 20 MB
